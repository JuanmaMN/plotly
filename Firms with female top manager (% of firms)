## Firms with female top manager (% of firms)

Published: http://rpubs.com/Juanma7/382414


#############   Markdown code

1.   Upload packages and datasets


````{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyr)
library(dplyr)
library(readxl)
library(scales)
library(ggplot2)  # We've also populated it with ggplot
library(plotly)

library(readr)
Female_as_top_manager <- read_csv("~/R/Female_as_top_manager.csv")
View(Female_as_top_manager)


```

2.  Comments

## Firms with female top manager (% of firms)


With this analysis, we want to show the percentage of Firms with Female top managers. We've used 2016 data from [World Bank](http://www.worldbank.org/).


[Data source](https://data.worldbank.org/indicator/IC.FRM.FEMM.ZS)


3. Create kable table

```{r echo=FALSE, results='asis', warning = FALSE}
library(knitr)
library(kableExtra)

kable(Female_as_top_manager [1:5,], "html", caption = "Sample Data Table.", align=c(rep('c', 5))) %>%  kable_styling(bootstrap_options = "striped", full_width = F, position = "center")
```

4. Plotly

## Visualization with plotly

Plotly is a visualization package available in R studio. 

In the below graph, we can see the the percentage of Female as top managers in the different countries and regions we've got data on from the [World Bank](http://www.worldbank.org/).  

This graph shows 2016 data which we hope we can update in order to see future trends.

Please zoom in or out to see all countries.



```{r pressure, echo=FALSE, warning = FALSE}
x <- list(title = "% Female as top managers ")
y <- list(title = " ")

m <- list(
  l = 200,
  r = 10,
  b = 50,
  t = 10,
  pad = 2
)

p <-   plot_ly(Female_as_top_manager, 
               x = ~Percentage_of_firms_top_managers, 
               y = ~reorder(Country, Percentage_of_firms_top_managers), 
               text =  ~paste('</br> Country: ', Country,
                              
                              '</br> % Female as top managers: ', comma_format()(Percentage_of_firms_top_managers),
                              
                              '</br> Year: ', Year), 
              
               type = 'bar',
               
               marker = list(color = 'rgb(166,206,227)',
                             line = list(color = 'rgb(8,48,107)',
                                         width = 1.5))) %>%
  layout(xaxis = list(title = "%"),
         yaxis = list(title = ""),
         
         annotations = 
           list(text = "Data from data.worldbank.org", 
                showarrow = F, xref='paper', yref='paper', 
                xref = 'paper', x = 1,
                yref = 'paper', y = 0,
                font=list(size=10, color="black"))
         ) %>%
  layout(margin = m)
  
  


p
```


5.  Code, questions and feedback


The code for this article is publish in my [github account](https://github.com/JuanmaMN).

Please feel free to reach out for any question or feedback.
